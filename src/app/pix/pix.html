<!-- Modal for boleto payment -->
<div class="modal-overlay">
  <div class="modal">
    <div class="modal-header">
      <h2 class="modal-title">Pix</h2>
    </div>

    <ng-container *ngIf="modo === 'menu'">
        
        <div class="action-buttons flex flex-col items-center space-y-2 max-w-xs mx-auto">
          <button
          *ngIf="temPix"
          class="bg-indigo-600 text-white rounded-md py-2 mt-8 font-semibold hover:bg-indigo-700 transition w-full"
          (click)="modo = 'transferencia'"
        >
          TransferÃªncia
        </button>

        <button
          *ngIf="temPix === false"
          class="bg-blue-600 text-white rounded-md py-2 mt-8 font-semibold hover:bg-blue-700 transition w-full"
          (click)="modo = 'chave'"
        >
          Criar Chave Pix
        </button>

        <button
          (click)="closeModal()"
          class="mt-2 text-gray-600 hover:text-gray-900"
        >
          Cancelar
        </button>
      </div>
    </ng-container>

    <div class="modal-body">
      <div class="form-group" *ngIf="modo === 'transferencia'">
        <label *ngIf="!exibirSenha" class="form-label">Enviar Pix</label>
        <input
          *ngIf="!exibirSenha"
          type="text"
          placeholder="Chave Pix (e-mail, telefone ou CPF)"
          [(ngModel)]="going"
          class="form-input"
        />
        <input
          *ngIf="!exibirSenha"
          type="number"
          placeholder="Digite o valor"
          [(ngModel)]="amount"
          [min]="0"
          [step]="0.01"
          class="form-input"
        />

        <div *ngIf="exibirSenha" class="flex flex-col space-y-2">
          <div>
            Enviar <strong>R$ {{ valorPix | number : "1.2-2" }}</strong> para
            <strong>{{ chavePix }}</strong>
          </div>

          <input
            type="password"
            placeholder="Digite sua senha"
            [(ngModel)]="senha"
            (input)="mensagemErro = null"
            class="form-input"
          />

          <div *ngIf="mensagemErro" class="text-red-600 font-semibold mt-2">
            {{ mensagemErro }}
          </div>
        </div>

        <div class="action-buttons">
          <button
            [disabled]="!pixKey && !name"
            class="btn btn-primary bg-indigo-600"
            id="payBtn"
            (click)="enviarPix()"
          >
            {{ chaveEmEdicao ? "Atualizar" : "Salvar" }}
          </button>

          <button (click)="modo = 'menu'" class="btn btn-secondary">
            Voltar ao menu
          </button>
        </div>
      </div>

      <div class="form-group" *ngIf="modo === 'chave'">
        <label *ngIf="!exibirSenha" class="form-label">Minha chave pix</label>
        <ul class="space-y-1 text-sm text-gray-700 mb-4">
          <li *ngFor="let chave of chaves">
            <span>{{ chave.tipo }}: {{ chave.valor }}</span>
            <button
              class="ml-2 text-blue-600 hover:underline"
              (click)="selecionarChaveParaEditar(chave)"
            >
              Editar
            </button>
          </li>
        </ul>

        <input
          type="text"
          placeholder="Nome da chave"
          [(ngModel)]="name"
          class="form-input"
        />

        <input
          type="text"
          placeholder="Nova chave Pix"
          [(ngModel)]="pixKey"
          class="form-input"
        />

        <div *ngIf="exibirSenha" class="flex flex-col space-y-2">
          <div>
            Enviar <strong>R$ {{ valorPix | number : "1.2-2" }}</strong> para
            <strong>{{ chavePix }}</strong>
          </div>

          <input
            type="password"
            placeholder="Digite sua senha"
            [(ngModel)]="senha"
            (input)="mensagemErro = null"
            class="form-input"
          />

          <div *ngIf="mensagemErro" class="text-red-600 font-semibold mt-2">
            {{ mensagemErro }}
          </div>
        </div>

        <div class="action-buttons">
          <button
            class="btn btn-primary bg-indigo-600"
            id="payBtn"
            (click)="criarPix()"
          >
            {{ exibirSenha ? "Enviar Pix" : "Confirmar" }}
          </button>
          <button (click)="modo = 'menu'" class="btn btn-secondary">
            Voltar ao menu
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
