<header>
  <h1 style="color: #fff">NovaBankTech</h1>
  <nav>
    <div class="dropdown-container">
      <a (click)="toggleDropdown($event)" class="dropdown-toggle">
        <fa-icon [icon]="faCog" style="color: white"></fa-icon>
        <span style="color: #ffffff">Configurações</span>
        <fa-icon
          [icon]="faChevronDown"
          style="color: white"
          [class.rotated]="isDropdownOpen"
        ></fa-icon>
      </a>

      <div class="dropdown-menu" [class.show]="isDropdownOpen">
        <a class="dropdown-item" (click)="openModal(EditarConta)">
          <fa-icon [icon]="faEdit" style="color: white"></fa-icon>
          <span>Editar Conta</span>
          <fa-icon
            class="item-chevron"
            [icon]="faChevronRight"
            style="color: white"
          ></fa-icon>
        </a>

        <a class="dropdown-item-excluir" (click)="abrirModalExclusao()">
          <fa-icon [icon]="faTrash" style="color: white"></fa-icon>
          <span>Desativar Conta</span>
          <fa-icon
            class="item-chevron"
            [icon]="faChevronRight"
            style="color: white"
          ></fa-icon>
        </a>

        <a class="dropdown-item" (click)="logout()">
          <fa-icon [icon]="faSignOutAlt" style="color: white"></fa-icon>
          <span>Sair</span>
          <fa-icon
            class="item-chevron"
            [icon]="faChevronRight"
            style="color: white"
          ></fa-icon>
        </a>
      </div>
    </div>
  </nav>
</header>

<main>
  <section class="saldo-card">
    <h1>Olá, {{ primeiroNome | titlecase }}</h1>
    <p>
      Você está logado na conta: <b>{{ accountData?.accountNumber }}</b>
    </p>
    <h2>
      <b>Saldo em conta: {{ saldoFormatado }} </b>
    </h2>
    <div>
      <fa-icon [icon]="faOlho" style="color: rgb(43, 43, 43)"></fa-icon>
    </div>
  </section>

  @if (showContent) {
  <section class="actions">
    <div class="action">
      <a (click)="openModal(Transferencia)">
        <div class="centro">
          <fa-icon
            [icon]="faTransfer"
            size="2x"
            style="color: #8b5fbf"
          ></fa-icon>
          <p>Transferir</p>
        </div>
      </a>
    </div>
    <div class="action">
      <a (click)="openModal(Deposito)">
        <div class="centro">
          <fa-icon
            [icon]="faDeposit"
            size="2x"
            style="color: #8b5fbf"
          ></fa-icon>
          <p>Depositar</p>
        </div>
      </a>
    </div>
    <div class="action">
      <a (click)="openModal(Withdraw)">
        <div class="centro">
          <fa-icon
            [icon]="faWithdraw"
            size="2x"
            style="color: #8b5fbf"
          ></fa-icon>
          <p>Sacar</p>
        </div>
      </a>
    </div>
    <div class="action">
      <a (click)="openModal(Pix)">
        <div class="centro">
          <fa-icon [icon]="faPix" size="2x" style="color: #8b5fbf"></fa-icon>
          <p>Pix</p>
        </div>
      </a>
    </div>
    <div class="action">
      <a (click)="openModal(Payment)">
        <div class="centro">
          <fa-icon [icon]="faBoleto" size="2x" style="color: #8b5fbf"></fa-icon>
          <p>Pagar Boleto</p>
        </div>
      </a>
    </div>
  </section>

  <section class="card-info">
    <!-- Cabeçalho da seção modernizado -->
    <div class="historico-header">
      <h3>Histórico de Transações</h3>
      <div class="filtros-periodo">
        <button (click)="history()">Todos</button>
        <button (click)="carregarMovimentacoesSemana()">Semana</button>
        <button (click)="carregarMovimentacoesMes()">Mês</button>
        <button (click)="openModal(Export)">Exportar</button>
      </div>
    </div>

    <!-- Container das transações modernizado -->
    <div class="transacoes-container">
      <div *ngIf="carregandoTransacoes" class="loading">
        Carregando transações...
      </div>

      <ul
        *ngIf="!carregandoTransacoes && movimentacoes.length > 0"
        class="transacoes-lista"
      >
        <li *ngFor="let item of movimentacoes" class="transacao-item">
          <div class="transacao-info">
            <div class="transacao-tipo">{{ item.movimentTypeEnum }}</div>
            <div class="transacao-data">
              {{ item.dateTimeMoviment | date : "dd/MM/yyyy HH:mm" }}
            </div>
          </div>
          <div class="transacao-valor">
            {{ item.amount | currency : "BRL" }}
          </div>
        </li>
      </ul>

      <div
        *ngIf="!carregandoTransacoes && valores.length === 0"
        class="sem-transacoes"
      >
        Nenhuma transação encontrada para o período selecionado.
      </div>
    </div>

    <!-- Paginação modernizada -->
    <div *ngIf="totalPaginas > 1" class="paginacao-footer">
      <div class="paginacao-wrapper">
        <!-- Botão Anterior -->
        <button
          (click)="irParaPaginaAnterior()"
          [disabled]="paginaAtual === 1"
          class="btn-navegacao anterior"
        >
          <fa-icon [icon]="faChevronLeft"></fa-icon>
          <span>Anterior</span>
        </button>

        <!-- Container dos Números -->
        <div class="numeros-container">
          <!-- Primeira página -->
          <button
            *ngIf="paginaAtual > 3"
            (click)="irParaPagina(1)"
            class="btn-numero"
          >
            1
          </button>

          <!-- Reticências iniciais -->
          <span *ngIf="paginaAtual > 4" class="reticencias">...</span>

          <!-- Páginas visíveis -->
          <button
            *ngFor="let pagina of getPaginasVisiveis()"
            (click)="irParaPagina(pagina)"
            [class.ativa]="pagina === paginaAtual"
            class="btn-numero"
          >
            {{ pagina }}
          </button>

          <!-- Reticências finais -->
          <span *ngIf="paginaAtual < totalPaginas - 3" class="reticencias">
            ...
          </span>

          <!-- Última página -->
          <button
            *ngIf="paginaAtual < totalPaginas - 2"
            (click)="irParaPagina(totalPaginas)"
            class="btn-numero"
          >
            {{ totalPaginas }}
          </button>
        </div>

        <!-- Botão Próxima -->
        <button
          (click)="irParaProximaPagina()"
          [disabled]="paginaAtual === totalPaginas"
          class="btn-navegacao proximo"
        >
          <span>Próxima</span>
          <fa-icon [icon]="faChevronRight"></fa-icon>
        </button>
      </div>

      <!-- Informações da paginação -->
      <div class="paginacao-info">
        <span class="info-itens">
          Mostrando {{ (paginaAtual - 1) * itensPorPagina + 1 }} -
          {{ Math.min(paginaAtual * itensPorPagina, totalItens) }}
          de {{ totalItens }} transações
        </span>
      </div>
    </div>
  </section>
  } @else {
  <router-outlet></router-outlet>
  }
</main>

<app-ai-chatbot></app-ai-chatbot>
